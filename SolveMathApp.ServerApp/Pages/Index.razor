@page "/"
@using SolveMathApp.ServerApp.Providers
@using System.IdentityModel.Tokens.Jwt
@inject AuthenticationStateProvider AuthenticationStateProvider


@attribute [Authorize]

<PageTitle>Index</PageTitle>

<h1>
    Welcome, <span class="text-primary">@UserName</span>!
</h1>


What would you like to do next?
<ul>
    <li><a href="age">Calculate my Age</a></li>
    <li><a href="distance">Calculate Distance</a></li> 
  @*   <li><a href="factorial">Calculate Factorial</a></li> *@
   
</ul>


@code {
    private int currentCount = 0;

    private void IncrementCount()
    {
        currentCount++;
    }

    private string? UserName;


    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        if (user.Identity?.IsAuthenticated == true)
        {
            UserName = user.FindFirst(JwtRegisteredClaimNames.UniqueName)?.Value ?? "User";
        }
    }
}
